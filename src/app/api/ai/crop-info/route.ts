import { NextRequest, NextResponse } from 'next/server';

export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
    const { query, language } = body;

    if (!query) {
      return NextResponse.json(
        { error: 'Query is required' },
        { status: 400 }
      );
    }

    // Crop information database (In production, use OpenAI API for dynamic responses)
    const cropDatabase: { [key: string]: any } = {
      '‡≤ü‡≥ä‡≤Æ‡≥á‡≤ü‡≥ä': {
        cropName: 'üçÖ ‡≤ü‡≥ä‡≤Æ‡≥á‡≤ü‡≥ä (Tomato)',
        climate: `‡≤π‡≤µ‡≤æ‡≤Æ‡≤æ‡≤® ‡≤Ö‡≤µ‡≤∂‡≥ç‡≤Ø‡≤ï‡≤§‡≥Ü‡≤ó‡≤≥‡≥Å:
- ‡≤§‡≤æ‡≤™‡≤Æ‡≤æ‡≤®: 20-25¬∞C (‡≤π‡≤ó‡≤≤‡≥Å), 15-20¬∞C (‡≤∞‡≤æ‡≤§‡≥ç‡≤∞‡≤ø)
- ‡≤Æ‡≤≥‡≥Ü: 50-150 ‡≤∏‡≥Ü‡≤Ç.‡≤Æ‡≥Ä ‡≤µ‡≤æ‡≤∞‡≥ç‡≤∑‡≤ø‡≤ï
- ‡≤∏‡≥Ç‡≤∞‡≥ç‡≤Ø‡≤® ‡≤¨‡≥Ü‡≤≥‡≤ï‡≥Å: ‡≤¶‡≤ø‡≤®‡≤ï‡≥ç‡≤ï‡≥Ü 6-8 ‡≤ó‡≤Ç‡≤ü‡≥Ü‡≤ó‡≤≥‡≥Å
- ‡≤§‡≥á‡≤µ‡≤æ‡≤Ç‡≤∂: ‡≤Æ‡≤ß‡≥ç‡≤Ø‡≤Æ (60-80%)`,
        soilType: `‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤Ö‡≤µ‡≤∂‡≥ç‡≤Ø‡≤ï‡≤§‡≥Ü‡≤ó‡≤≥‡≥Å:
- ‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤™‡≥ç‡≤∞‡≤ï‡≤æ‡≤∞: ‡≤Æ‡≤∞‡≤≥‡≥Å ‡≤Æ‡≤ü‡≥ç‡≤ü‡≤ø ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å
- pH ‡≤Æ‡≤ü‡≥ç‡≤ü: 6.0-7.0
- ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤í‡≤≥‡≤ö‡≤∞‡≤Ç‡≤°‡≤ø‡≤Ø‡≤æ‡≤¶ ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å
- ‡≤∏‡≤æ‡≤µ‡≤Ø‡≤µ ‡≤™‡≤¶‡≤æ‡≤∞‡≥ç‡≤• ‡≤∏‡≤Æ‡≥É‡≤¶‡≥ç‡≤ß`,
        tips: `‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤∏‡≤≤‡≤π‡≥Ü‡≤ó‡≤≥‡≥Å:
1. ‡≤®‡≤∞‡≥ç‡≤∏‡≤∞‡≤ø‡≤Ø‡≤≤‡≥ç‡≤≤‡≤ø ‡≤¨‡≥Ä‡≤ú‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤Æ‡≥ä‡≤≥‡≤ï‡≥Ü ‡≤π‡≤æ‡≤ï‡≤ø
2. 30-45 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥ ‡≤®‡≤Ç‡≤§‡≤∞ ‡≤®‡≥Ü‡≤ü‡≥ç‡≤ü‡≥Å ‡≤Æ‡≤æ‡≤°‡≤ø
3. ‡≤∏‡≤æ‡≤≤‡≤ø‡≤®‡≤ø‡≤Ç‡≤¶ ‡≤∏‡≤æ‡≤≤‡≤ø‡≤ó‡≥Ü 75 ‡≤∏‡≥Ü‡≤Ç.‡≤Æ‡≥Ä ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤ó‡≤ø‡≤°‡≤¶‡≤ø‡≤Ç‡≤¶ ‡≤ó‡≤ø‡≤°‡≤ï‡≥ç‡≤ï‡≥Ü 60 ‡≤∏‡≥Ü‡≤Ç.‡≤Æ‡≥Ä ‡≤Ö‡≤Ç‡≤§‡≤∞
4. ‡≤∏‡≤æ‡≤µ‡≤Ø‡≤µ ‡≤ó‡≥ä‡≤¨‡≥ç‡≤¨‡≤∞ ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å NPK (19:19:19) ‡≤¨‡≤≥‡≤∏‡≤ø
5. ‡≤∞‡≥ã‡≤ó ‡≤®‡≤ø‡≤Ø‡≤Ç‡≤§‡≥ç‡≤∞‡≤£‡≤ï‡≥ç‡≤ï‡≥Ü ‡≤®‡≤ø‡≤Ø‡≤Æ‡≤ø‡≤§‡≤µ‡≤æ‡≤ó‡≤ø ‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ø‡≤∏‡≤ø`,
        season: `‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤ã‡≤§‡≥Å:
- ‡≤ñ‡≤∞‡≥Ä‡≤´‡≥ç: ‡≤ú‡≥Ç‡≤®‡≥ç-‡≤ú‡≥Å‡≤≤‡≥à
- ‡≤∞‡≤¨‡≤ø: ‡≤Ö‡≤ï‡≥ç‡≤ü‡≥ã‡≤¨‡≤∞‡≥ç-‡≤®‡≤µ‡≥Ü‡≤Ç‡≤¨‡≤∞‡≥ç
- ‡≤¨‡≥á‡≤∏‡≤ø‡≤ó‡≥Ü: ‡≤ú‡≤®‡≤µ‡≤∞‡≤ø-‡≤´‡≥Ü‡≤¨‡≥ç‡≤∞‡≤µ‡≤∞‡≤ø
- ‡≤á‡≤≥‡≥Å‡≤µ‡≤∞‡≤ø: 60-70 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≤≤‡≥ç‡≤≤‡≤ø`,
        irrigation: `‡≤®‡≥Ä‡≤∞‡≤æ‡≤µ‡≤∞‡≤ø:
- ‡≤®‡≤ø‡≤Ø‡≤Æ‡≤ø‡≤§ ‡≤®‡≥Ä‡≤∞‡≤æ‡≤µ‡≤∞‡≤ø ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø
- ‡≤¨‡≥á‡≤∏‡≤ø‡≤ó‡≥Ü‡≤Ø‡≤≤‡≥ç‡≤≤‡≤ø 4-5 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≤ø‡≤ó‡≥ä‡≤Æ‡≥ç‡≤Æ‡≥Ü
- ‡≤ö‡≤≥‡≤ø‡≤ó‡≤æ‡≤≤‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø 7-10 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≤ø‡≤ó‡≥ä‡≤Æ‡≥ç‡≤Æ‡≥Ü
- ‡≤°‡≥ç‡≤∞‡≤ø‡≤™‡≥ç ‡≤®‡≥Ä‡≤∞‡≤æ‡≤µ‡≤∞‡≤ø ‡≤Ö‡≤§‡≥ç‡≤Ø‡≥Å‡≤§‡≥ç‡≤§‡≤Æ`,
      },
      '‡≤Ü‡≤≤‡≥Ç‡≤ó‡≤°‡≥ç‡≤°‡≥Ü': {
        cropName: 'ü•î ‡≤Ü‡≤≤‡≥Ç‡≤ó‡≤°‡≥ç‡≤°‡≥Ü (Potato)',
        climate: `‡≤π‡≤µ‡≤æ‡≤Æ‡≤æ‡≤® ‡≤Ö‡≤µ‡≤∂‡≥ç‡≤Ø‡≤ï‡≤§‡≥Ü‡≤ó‡≤≥‡≥Å:
- ‡≤§‡≤æ‡≤™‡≤Æ‡≤æ‡≤®: 15-20¬∞C (‡≤Ö‡≤§‡≥ç‡≤Ø‡≥Å‡≤§‡≥ç‡≤§‡≤Æ)
- ‡≤§‡≤Ç‡≤™‡≤æ‡≤¶ ‡≤π‡≤µ‡≤æ‡≤Æ‡≤æ‡≤® ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø
- ‡≤∏‡≥Ç‡≤∞‡≥ç‡≤Ø‡≤® ‡≤¨‡≥Ü‡≤≥‡≤ï‡≥Å: ‡≤™‡≥Ç‡≤∞‡≥ç‡≤£ ‡≤∏‡≥Ç‡≤∞‡≥ç‡≤Ø‡≤® ‡≤¨‡≥Ü‡≤≥‡≤ï‡≥Å
- ‡≤Æ‡≤Ç‡≤ú‡≥Å ‡≤π‡≤æ‡≤®‡≤ø‡≤ï‡≤æ‡≤∞‡≤ï`,
        soilType: `‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤Ö‡≤µ‡≤∂‡≥ç‡≤Ø‡≤ï‡≤§‡≥Ü‡≤ó‡≤≥‡≥Å:
- ‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤™‡≥ç‡≤∞‡≤ï‡≤æ‡≤∞: ‡≤Æ‡≤∞‡≤≥‡≥Å ‡≤Æ‡≤ü‡≥ç‡≤ü‡≤ø ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å
- pH ‡≤Æ‡≤ü‡≥ç‡≤ü: 5.5-6.5
- ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤í‡≤≥‡≤ö‡≤∞‡≤Ç‡≤°‡≤ø‡≤Ø‡≤æ‡≤¶ ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å
- ‡≤∏‡≤°‡≤ø‡≤≤ ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å ‡≤Ö‡≤§‡≥ç‡≤Ø‡≥Å‡≤§‡≥ç‡≤§‡≤Æ`,
        tips: `‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤∏‡≤≤‡≤π‡≥Ü‡≤ó‡≤≥‡≥Å:
1. ‡≤∏‡≤£‡≥ç‡≤£ ‡≤ó‡≥Ü‡≤°‡≥ç‡≤°‡≥Ü‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤¨‡≥Ä‡≤ú‡≤µ‡≤æ‡≤ó‡≤ø ‡≤¨‡≤≥‡≤∏‡≤ø
2. ‡≤∏‡≤æ‡≤≤‡≤ø‡≤®‡≤ø‡≤Ç‡≤¶ ‡≤∏‡≤æ‡≤≤‡≤ø‡≤ó‡≥Ü 50-60 ‡≤∏‡≥Ü‡≤Ç.‡≤Æ‡≥Ä ‡≤Ö‡≤Ç‡≤§‡≤∞
3. ‡≤ó‡≥Ü‡≤°‡≥ç‡≤°‡≥Ü‡≤Ø‡≤ø‡≤Ç‡≤¶ ‡≤ó‡≥Ü‡≤°‡≥ç‡≤°‡≥Ü‡≤ó‡≥Ü 20-25 ‡≤∏‡≥Ü‡≤Ç.‡≤Æ‡≥Ä ‡≤Ö‡≤Ç‡≤§‡≤∞
4. ‡≤∏‡≤æ‡≤µ‡≤Ø‡≤µ ‡≤ó‡≥ä‡≤¨‡≥ç‡≤¨‡≤∞ ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å NPK ‡≤ó‡≥ä‡≤¨‡≥ç‡≤¨‡≤∞ ‡≤¨‡≤≥‡≤∏‡≤ø
5. ‡≤ï‡≤≥‡≥Ü ‡≤®‡≤ø‡≤Ø‡≤Ç‡≤§‡≥ç‡≤∞‡≤£ ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å ‡≤π‡≤æ‡≤ï‡≥Å‡≤µ‡≥Å‡≤¶‡≥Å ‡≤Æ‡≥Å‡≤ñ‡≥ç‡≤Ø`,
        season: `‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤ã‡≤§‡≥Å:
- ‡≤∞‡≤¨‡≤ø: ‡≤Ö‡≤ï‡≥ç‡≤ü‡≥ã‡≤¨‡≤∞‡≥ç-‡≤®‡≤µ‡≥Ü‡≤Ç‡≤¨‡≤∞‡≥ç
- ‡≤ñ‡≤∞‡≥Ä‡≤´‡≥ç: ‡≤ú‡≥Å‡≤≤‡≥à-‡≤Ü‡≤ó‡≤∏‡≥ç‡≤ü‡≥ç (‡≤é‡≤§‡≥ç‡≤§‡≤∞‡≤¶ ‡≤™‡≥ç‡≤∞‡≤¶‡≥á‡≤∂‡≤ó‡≤≥‡≥Å)
- ‡≤á‡≤≥‡≥Å‡≤µ‡≤∞‡≤ø: 90-120 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≤≤‡≥ç‡≤≤‡≤ø`,
        irrigation: `‡≤®‡≥Ä‡≤∞‡≤æ‡≤µ‡≤∞‡≤ø:
- ‡≤Æ‡≤ß‡≥ç‡≤Ø‡≤Æ ‡≤®‡≥Ä‡≤∞‡≤æ‡≤µ‡≤∞‡≤ø ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø
- 7-10 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≤ø‡≤ó‡≥ä‡≤Æ‡≥ç‡≤Æ‡≥Ü
- ‡≤ó‡≥Ü‡≤°‡≥ç‡≤°‡≥Ü ‡≤∞‡≤ö‡≤®‡≥Ü‡≤Ø ‡≤∏‡≤Æ‡≤Ø‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤®‡≤ø‡≤Ø‡≤Æ‡≤ø‡≤§ ‡≤®‡≥Ä‡≤∞‡≥Å
- ‡≤Ö‡≤§‡≤ø‡≤Ø‡≤æ‡≤¶ ‡≤®‡≥Ä‡≤∞‡≥Å ‡≤®‡≥Ä‡≤°‡≤¨‡≥á‡≤°‡≤ø`,
      },
      '‡≤¨‡≤§‡≥ç‡≤§': {
        cropName: 'üåæ ‡≤¨‡≤§‡≥ç‡≤§ (Rice)',
        climate: `‡≤π‡≤µ‡≤æ‡≤Æ‡≤æ‡≤® ‡≤Ö‡≤µ‡≤∂‡≥ç‡≤Ø‡≤ï‡≤§‡≥Ü‡≤ó‡≤≥‡≥Å:
- ‡≤§‡≤æ‡≤™‡≤Æ‡≤æ‡≤®: 25-35¬∞C
- ‡≤Æ‡≤≥‡≥Ü: 150-300 ‡≤∏‡≥Ü‡≤Ç.‡≤Æ‡≥Ä ‡≤µ‡≤æ‡≤∞‡≥ç‡≤∑‡≤ø‡≤ï
- ‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≥Å ‡≤§‡≥á‡≤µ‡≤æ‡≤Ç‡≤∂ ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø
- ‡≤Æ‡≤æ‡≤®‡≥ç‡≤∏‡≥Ç‡≤®‡≥ç ‡≤ã‡≤§‡≥Å‡≤µ‡≤ø‡≤®‡≤≤‡≥ç‡≤≤‡≤ø ‡≤â‡≤§‡≥ç‡≤§‡≤Æ`,
        soilType: `‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤Ö‡≤µ‡≤∂‡≥ç‡≤Ø‡≤ï‡≤§‡≥Ü‡≤ó‡≤≥‡≥Å:
- ‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤™‡≥ç‡≤∞‡≤ï‡≤æ‡≤∞: ‡≤Æ‡≤ü‡≥ç‡≤ü‡≤ø ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å
- pH ‡≤Æ‡≤ü‡≥ç‡≤ü: 5.5-7.0
- ‡≤®‡≥Ä‡≤∞‡≥Å ‡≤π‡≤ø‡≤°‡≤ø‡≤¶‡≤ø‡≤°‡≥Å‡≤µ ‡≤∏‡≤æ‡≤Æ‡≤∞‡≥ç‡≤•‡≥ç‡≤Ø ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø
- ‡≤´‡≤≤‡≤µ‡≤§‡≥ç‡≤§‡≤§‡≥Ü ‡≤∏‡≤Æ‡≥É‡≤¶‡≥ç‡≤ß ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å`,
        tips: `‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤∏‡≤≤‡≤π‡≥Ü‡≤ó‡≤≥‡≥Å:
1. ‡≤≠‡≤¶‡≥ç‡≤∞‡≤§‡≤æ ‡≤¨‡≥Ä‡≤ú‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤¨‡≤≥‡≤∏‡≤ø
2. ‡≤®‡≤∞‡≥ç‡≤∏‡≤∞‡≤ø‡≤Ø‡≤≤‡≥ç‡≤≤‡≤ø 25-30 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≥Å ‡≤Æ‡≥ä‡≤≥‡≤ï‡≥Ü ‡≤π‡≤æ‡≤ï‡≤ø
3. 20x15 ‡≤∏‡≥Ü‡≤Ç.‡≤Æ‡≥Ä ‡≤Ö‡≤Ç‡≤§‡≤∞‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤®‡≥Ü‡≤ü‡≥ç‡≤ü‡≥Å ‡≤Æ‡≤æ‡≤°‡≤ø
4. ‡≤∏‡≤æ‡≤µ‡≤Ø‡≤µ ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤∞‡≤æ‡≤∏‡≤æ‡≤Ø‡≤®‡≤ø‡≤ï ‡≤ó‡≥ä‡≤¨‡≥ç‡≤¨‡≤∞ ‡≤∏‡≤Ç‡≤Ø‡≥ã‡≤ú‡≤®‡≥Ü
5. ‡≤ï‡≤≥‡≥Ü ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤∞‡≥ã‡≤ó ‡≤®‡≤ø‡≤Ø‡≤Ç‡≤§‡≥ç‡≤∞‡≤£ ‡≤Æ‡≥Å‡≤ñ‡≥ç‡≤Ø`,
        season: `‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤ã‡≤§‡≥Å:
- ‡≤ñ‡≤∞‡≥Ä‡≤´‡≥ç: ‡≤ú‡≥Ç‡≤®‡≥ç-‡≤ú‡≥Å‡≤≤‡≥à (‡≤Æ‡≥Å‡≤ñ‡≥ç‡≤Ø)
- ‡≤∞‡≤¨‡≤ø: ‡≤®‡≤µ‡≥Ü‡≤Ç‡≤¨‡≤∞‡≥ç-‡≤°‡≤ø‡≤∏‡≥Ü‡≤Ç‡≤¨‡≤∞‡≥ç
- ‡≤¨‡≥á‡≤∏‡≤ø‡≤ó‡≥Ü: ‡≤´‡≥Ü‡≤¨‡≥ç‡≤∞‡≤µ‡≤∞‡≤ø-‡≤Æ‡≤æ‡≤∞‡≥ç‡≤ö‡≥ç
- ‡≤á‡≤≥‡≥Å‡≤µ‡≤∞‡≤ø: 120-150 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≤≤‡≥ç‡≤≤‡≤ø`,
        irrigation: `‡≤®‡≥Ä‡≤∞‡≤æ‡≤µ‡≤∞‡≤ø:
- ‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≥Å ‡≤®‡≥Ä‡≤∞‡≤æ‡≤µ‡≤∞‡≤ø ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø
- ‡≤π‡≥ä‡≤≤‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø 5-10 ‡≤∏‡≥Ü‡≤Ç.‡≤Æ‡≥Ä ‡≤®‡≥Ä‡≤∞‡≥Å ‡≤á‡≤∞‡≤ø‡≤∏‡≤ø
- ‡≤®‡≥Ü‡≤ü‡≥ç‡≤ü‡≥Å ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶ ‡≤®‡≤Ç‡≤§‡≤∞ ‡≤®‡≤ø‡≤Ø‡≤Æ‡≤ø‡≤§ ‡≤®‡≥Ä‡≤∞‡≥Å
- ‡≤™‡≤ï‡≥ç‡≤µ‡≤§‡≥Ü ‡≤π‡≤Ç‡≤§‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤®‡≥Ä‡≤∞‡≥Å ‡≤§‡≤ó‡≥ç‡≤ó‡≤ø‡≤∏‡≤ø`,
      },
      '‡≤ó‡≥ã‡≤ß‡≤ø': {
        cropName: 'üåæ ‡≤ó‡≥ã‡≤ß‡≤ø (Wheat)',
        climate: `‡≤π‡≤µ‡≤æ‡≤Æ‡≤æ‡≤® ‡≤Ö‡≤µ‡≤∂‡≥ç‡≤Ø‡≤ï‡≤§‡≥Ü‡≤ó‡≤≥‡≥Å:
- ‡≤§‡≤æ‡≤™‡≤Æ‡≤æ‡≤®: 20-25¬∞C (‡≤¨‡≥Ü‡≤≥‡≤µ‡≤£‡≤ø‡≤ó‡≥Ü)
- ‡≤§‡≤Ç‡≤™‡≤æ‡≤¶ ‡≤ö‡≤≥‡≤ø‡≤ó‡≤æ‡≤≤ ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø
- ‡≤Æ‡≤≥‡≥Ü: 50-75 ‡≤∏‡≥Ü‡≤Ç.‡≤Æ‡≥Ä
- ‡≤∂‡≥Å‡≤∑‡≥ç‡≤ï ‡≤π‡≤µ‡≤æ‡≤Æ‡≤æ‡≤®‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤∏‡≥Å‡≤ó‡≥ç‡≤ó‡≤ø`,
        soilType: `‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤Ö‡≤µ‡≤∂‡≥ç‡≤Ø‡≤ï‡≤§‡≥Ü‡≤ó‡≤≥‡≥Å:
- ‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤™‡≥ç‡≤∞‡≤ï‡≤æ‡≤∞: ‡≤Æ‡≤ü‡≥ç‡≤ü‡≤ø ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å ‡≤Ö‡≤•‡≤µ‡≤æ ‡≤Æ‡≤ü‡≥ç‡≤ü‡≤ø ‡≤Æ‡≤∞‡≤≥‡≥Å ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å
- pH ‡≤Æ‡≤ü‡≥ç‡≤ü: 6.0-7.5
- ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤í‡≤≥‡≤ö‡≤∞‡≤Ç‡≤°‡≤ø‡≤Ø‡≤æ‡≤¶ ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å
- ‡≤´‡≤≤‡≤µ‡≤§‡≥ç‡≤§‡≤§‡≥Ü ‡≤∏‡≤Æ‡≥É‡≤¶‡≥ç‡≤ß`,
        tips: `‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤∏‡≤≤‡≤π‡≥Ü‡≤ó‡≤≥‡≥Å:
1. ‡≤â‡≤®‡≥ç‡≤®‡≤§ ‡≤§‡≤≥‡≤ø ‡≤¨‡≥Ä‡≤ú ‡≤¨‡≤≥‡≤∏‡≤ø
2. 100-125 ‡≤ï‡≥Ü‡≤ú‡≤ø ‡≤¨‡≥Ä‡≤ú/‡≤π‡≥Ü‡≤ï‡≥ç‡≤ü‡≥á‡≤∞‡≥ç
3. ‡≤∏‡≤æ‡≤≤‡≤ø‡≤®‡≤ø‡≤Ç‡≤¶ ‡≤∏‡≤æ‡≤≤‡≤ø‡≤ó‡≥Ü 20-25 ‡≤∏‡≥Ü‡≤Ç.‡≤Æ‡≥Ä ‡≤Ö‡≤Ç‡≤§‡≤∞
4. 3 ‡≤¨‡≤æ‡≤∞‡≤ø ‡≤®‡≥Ä‡≤∞‡≤æ‡≤µ‡≤∞‡≤ø (CRI, Tillering, Heading)
5. NPK ‡≤ó‡≥ä‡≤¨‡≥ç‡≤¨‡≤∞ ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤ï‡≤≥‡≥Ü ‡≤®‡≤ø‡≤Ø‡≤Ç‡≤§‡≥ç‡≤∞‡≤£`,
        season: `‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤ã‡≤§‡≥Å:
- ‡≤∞‡≤¨‡≤ø: ‡≤®‡≤µ‡≥Ü‡≤Ç‡≤¨‡≤∞‡≥ç-‡≤°‡≤ø‡≤∏‡≥Ü‡≤Ç‡≤¨‡≤∞‡≥ç (‡≤Æ‡≥Å‡≤ñ‡≥ç‡≤Ø)
- ‡≤¨‡≥Ä‡≤ú ‡≤¨‡≤ø‡≤§‡≥ç‡≤§‡≤®‡≥Ü: ‡≤Ö‡≤ï‡≥ç‡≤ü‡≥ã‡≤¨‡≤∞‡≥ç-‡≤®‡≤µ‡≥Ü‡≤Ç‡≤¨‡≤∞‡≥ç
- ‡≤á‡≤≥‡≥Å‡≤µ‡≤∞‡≤ø: 120-150 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≤≤‡≥ç‡≤≤‡≤ø
- ‡≤∏‡≥Å‡≤ó‡≥ç‡≤ó‡≤ø: ‡≤Æ‡≤æ‡≤∞‡≥ç‡≤ö‡≥ç-‡≤è‡≤™‡≥ç‡≤∞‡≤ø‡≤≤‡≥ç`,
        irrigation: `‡≤®‡≥Ä‡≤∞‡≤æ‡≤µ‡≤∞‡≤ø:
- 4-6 ‡≤¨‡≤æ‡≤∞‡≤ø ‡≤®‡≥Ä‡≤∞‡≤æ‡≤µ‡≤∞‡≤ø ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø
- CRI stage (20-25 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≥Å) - ‡≤Æ‡≥Å‡≤ñ‡≥ç‡≤Ø
- Tillering stage (40-45 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≥Å)
- Flowering stage (60-65 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≥Å)`,
      },
      '‡≤∞‡≤æ‡≤ó‡≤ø': {
        cropName: 'üåæ ‡≤∞‡≤æ‡≤ó‡≤ø (Finger Millet)',
        climate: `‡≤π‡≤µ‡≤æ‡≤Æ‡≤æ‡≤® ‡≤Ö‡≤µ‡≤∂‡≥ç‡≤Ø‡≤ï‡≤§‡≥Ü‡≤ó‡≤≥‡≥Å:
- ‡≤§‡≤æ‡≤™‡≤Æ‡≤æ‡≤®: 25-30¬∞C
- ‡≤Æ‡≤≥‡≥Ü: 50-100 ‡≤∏‡≥Ü‡≤Ç.‡≤Æ‡≥Ä
- ‡≤¨‡≤∞ ‡≤∏‡≤π‡≤ø‡≤∏‡≥Å‡≤µ ‡≤¨‡≥Ü‡≤≥‡≥Ü
- ‡≤Ö‡≤∞‡≥Ü ‡≤∂‡≥Å‡≤∑‡≥ç‡≤ï ‡≤™‡≥ç‡≤∞‡≤¶‡≥á‡≤∂‡≤ï‡≥ç‡≤ï‡≥Ü ‡≤∏‡≥Ç‡≤ï‡≥ç‡≤§`,
        soilType: `‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤Ö‡≤µ‡≤∂‡≥ç‡≤Ø‡≤ï‡≤§‡≥Ü‡≤ó‡≤≥‡≥Å:
- ‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤™‡≥ç‡≤∞‡≤ï‡≤æ‡≤∞: ‡≤ï‡≥Ü‡≤Ç‡≤™‡≥Å ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å, ‡≤ï‡≤™‡≥ç‡≤™‡≥Å ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å
- pH ‡≤Æ‡≤ü‡≥ç‡≤ü: 5.0-8.2 (‡≤µ‡≤ø‡≤∂‡≤æ‡≤≤ ‡≤µ‡≥ç‡≤Ø‡≤æ‡≤™‡≥ç‡≤§‡≤ø)
- ‡≤¨‡≤° ‡≤Æ‡≤£‡≥ç‡≤£‡≤ø‡≤®‡≤≤‡≥ç‡≤≤‡≥Ç ‡≤¨‡≥Ü‡≤≥‡≥Ü‡≤Ø‡≥Å‡≤§‡≥ç‡≤§‡≤¶‡≥Ü
- ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤í‡≤≥‡≤ö‡≤∞‡≤Ç‡≤°‡≤ø‡≤Ø‡≤æ‡≤¶ ‡≤Æ‡≤£‡≥ç‡≤£‡≥Å`,
        tips: `‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤∏‡≤≤‡≤π‡≥Ü‡≤ó‡≤≥‡≥Å:
1. 10 ‡≤ï‡≥Ü‡≤ú‡≤ø ‡≤¨‡≥Ä‡≤ú/‡≤π‡≥Ü‡≤ï‡≥ç‡≤ü‡≥á‡≤∞‡≥ç
2. ‡≤∏‡≤æ‡≤≤‡≤ø‡≤®‡≤ø‡≤Ç‡≤¶ ‡≤∏‡≤æ‡≤≤‡≤ø‡≤ó‡≥Ü 20-25 ‡≤∏‡≥Ü‡≤Ç.‡≤Æ‡≥Ä
3. ‡≤∏‡≤æ‡≤µ‡≤Ø‡≤µ ‡≤ó‡≥ä‡≤¨‡≥ç‡≤¨‡≤∞ 10 ‡≤ü‡≤®‡≥ç/‡≤π‡≥Ü‡≤ï‡≥ç‡≤ü‡≥á‡≤∞‡≥ç
4. 2-3 ‡≤¨‡≤æ‡≤∞‡≤ø ‡≤ï‡≤≥‡≥Ü ‡≤§‡≥Ü‡≤ó‡≥Ü‡≤Ø‡≥Å‡≤µ‡≥Å‡≤¶‡≥Å
5. ‡≤™‡≥ã‡≤∑‡≤ï ‡≤∏‡≤Æ‡≥É‡≤¶‡≥ç‡≤ß ‡≤ß‡≤æ‡≤®‡≥ç‡≤Ø`,
        season: `‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤ã‡≤§‡≥Å:
- ‡≤ñ‡≤∞‡≥Ä‡≤´‡≥ç: ‡≤ú‡≥Ç‡≤®‡≥ç-‡≤ú‡≥Å‡≤≤‡≥à (‡≤Æ‡≥Å‡≤ñ‡≥ç‡≤Ø)
- ‡≤∞‡≤¨‡≤ø: ‡≤Ö‡≤ï‡≥ç‡≤ü‡≥ã‡≤¨‡≤∞‡≥ç-‡≤®‡≤µ‡≥Ü‡≤Ç‡≤¨‡≤∞‡≥ç
- ‡≤á‡≤≥‡≥Å‡≤µ‡≤∞‡≤ø: 120-140 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≤≤‡≥ç‡≤≤‡≤ø
- ‡≤¨‡≤∞ ‡≤™‡≥ç‡≤∞‡≤¶‡≥á‡≤∂‡≤ï‡≥ç‡≤ï‡≥Ü ‡≤Ö‡≤§‡≥ç‡≤Ø‡≥Å‡≤§‡≥ç‡≤§‡≤Æ`,
        irrigation: `‡≤®‡≥Ä‡≤∞‡≤æ‡≤µ‡≤∞‡≤ø:
- ‡≤µ‡≤∞‡≥ç‡≤∑‡≤æ‡≤ß‡≤æ‡≤∞‡≤ø‡≤§ ‡≤¨‡≥Ü‡≤≥‡≥Ü (‡≤Æ‡≤≥‡≥Ü ‡≤Ü‡≤ß‡≤æ‡≤∞‡≤ø‡≤§)
- ‡≤í‡≤£ ‡≤∏‡≤æ‡≤ó‡≥Å‡≤µ‡≤≥‡≤ø ‡≤∏‡≤æ‡≤ß‡≥ç‡≤Ø
- ‡≤®‡≥Ä‡≤∞‡≤æ‡≤µ‡≤∞‡≤ø ‡≤á‡≤¶‡≥ç‡≤¶‡≤∞‡≥Ü 2-3 ‡≤¨‡≤æ‡≤∞‡≤ø
- ‡≤¨‡≤∞ ‡≤∏‡≤π‡≤ø‡≤∏‡≥Å‡≤µ ‡≤∏‡≤æ‡≤Æ‡≤∞‡≥ç‡≤•‡≥ç‡≤Ø ‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≥Å`,
      },
    };

    // Find matching crop
    const lowerQuery = query.toLowerCase();
    let matchedCrop = null;

    for (const [key, value] of Object.entries(cropDatabase)) {
      if (lowerQuery.includes(key.toLowerCase()) || 
          lowerQuery.includes(value.cropName.toLowerCase())) {
        matchedCrop = value;
        break;
      }
    }

    // Return matched crop or default response
    if (matchedCrop) {
      return NextResponse.json(matchedCrop, { status: 200 });
    } else {
      return NextResponse.json({
        cropName: query,
        climate: `‡≤ï‡≥ç‡≤∑‡≤Æ‡≤ø‡≤∏‡≤ø, "${query}" ‡≤¨‡≥Ü‡≤≥‡≥Ü‡≤Ø ‡≤¨‡≤ó‡≥ç‡≤ó‡≥Ü ‡≤Æ‡≤æ‡≤π‡≤ø‡≤§‡≤ø ‡≤™‡≥ç‡≤∞‡≤∏‡≥ç‡≤§‡≥Å‡≤§ ‡≤≤‡≤≠‡≥ç‡≤Ø‡≤µ‡≤ø‡≤≤‡≥ç‡≤≤.\n\n‡≤≤‡≤≠‡≥ç‡≤Ø‡≤µ‡≤ø‡≤∞‡≥Å‡≤µ ‡≤¨‡≥Ü‡≤≥‡≥Ü‡≤ó‡≤≥‡≥Å:\n- ‡≤ü‡≥ä‡≤Æ‡≥á‡≤ü‡≥ä\n- ‡≤Ü‡≤≤‡≥Ç‡≤ó‡≤°‡≥ç‡≤°‡≥Ü\n- ‡≤¨‡≤§‡≥ç‡≤§\n- ‡≤ó‡≥ã‡≤ß‡≤ø\n- ‡≤∞‡≤æ‡≤ó‡≤ø`,
        soilType: '‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤Æ‡≥á‡≤≤‡≤ø‡≤® ‡≤ú‡≤®‡≤™‡≥ç‡≤∞‡≤ø‡≤Ø ‡≤¨‡≥Ü‡≤≥‡≥Ü‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤ø.',
        tips: '‡≤Ö‡≤•‡≤µ‡≤æ AI ‡≤∏‡≤π‡≤æ‡≤Ø‡≤ï‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤™‡≥ç‡≤∞‡≤∂‡≥ç‡≤®‡≥Ü‡≤Ø‡≤®‡≥ç‡≤®‡≥Å ‡≤ï‡≥á‡≤≥‡≤ø.',
        season: '‡≤®‡≤æ‡≤µ‡≥Å ‡≤∂‡≥Ä‡≤ò‡≥ç‡≤∞‡≤¶‡≤≤‡≥ç‡≤≤‡≥á ‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≥Å ‡≤¨‡≥Ü‡≤≥‡≥Ü‡≤ó‡≤≥ ‡≤Æ‡≤æ‡≤π‡≤ø‡≤§‡≤ø‡≤Ø‡≤®‡≥ç‡≤®‡≥Å ‡≤∏‡≥á‡≤∞‡≤ø‡≤∏‡≥Å‡≤§‡≥ç‡≤§‡≥á‡≤µ‡≥Ü.',
        irrigation: '‡≤ß‡≤®‡≥ç‡≤Ø‡≤µ‡≤æ‡≤¶‡≤ó‡≤≥‡≥Å! üôè',
      }, { status: 200 });
    }

  } catch (error) {
    console.error('Crop info error:', error);
    return NextResponse.json(
      { error: 'Internal server error: ' + error },
      { status: 500 }
    );
  }
}